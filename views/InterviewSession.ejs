<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= Entering_IID %></title>
    <style>
        #call {
            width: 100%;
            height: 90vh;
        }
    </style>
</head>
<body>

<!-- Hidden input field to store the interview link -->
<input type="hidden" value="<%= Entering_ILink %>" id="link">

<!-- Container for the Daily call frame -->
<div id="call"></div>

<!-- Controls for transcription -->
<div id="controls">
    <button id="start">Start transcription</button>
    <button id="stop">Stop transcription</button>
</div>

<!-- Container for displaying the transcript -->
<div id="transcript"></div>

<!-- Script to handle Daily call and transcription -->
<script crossorigin src="https://unpkg.com/@daily-co/daily-js"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        const link = document.getElementById("link").value;
        const callEl = document.getElementById("call");
        const transcriptEl = document.getElementById("transcript");
        const startBtn = document.getElementById("start");
        const stopBtn = document.getElementById("stop");

        const callFrame = DailyIframe.createFrame(callEl, {
            iframeStyle: { width: "100%", height: "90vh" }
        });

        callFrame.join({
            url: link,
            token: "YOUR_DAILY_CO_TOKEN"
        });

        startBtn.addEventListener("click", () => {
            callFrame.startTranscription();
        });

        callFrame.on("app-message", message => {
            if (message?.fromId === "transcription" && message.data?.is_final) {
                const p = document.createElement("p");
                p.textContent = `${message.data.user_name}: ${message.data.text}`;
                transcriptEl.appendChild(p);
            }
        });
    });
</script>

</body>
</html>
